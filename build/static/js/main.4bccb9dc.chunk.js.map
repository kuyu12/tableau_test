{"version":3,"sources":["components/Extension/ExportBtn/ExportBtn.js","components/func/func.js","components/Extension/Extension.js","components/Configure/SelectSheets/Sheet/Sheet.js","components/Configure/SelectSheets/SelectSheets.js","components/Configure/SelectColumns/Sheet/Column/Column.js","components/Configure/SelectColumns/Sheet/Sheet.js","components/Configure/SelectColumns/SelectColumns.js","components/Configure/ActionButtons/ActionButtons.js","components/Configure/ConfigureTab/ConfigureTab.js","components/Configure/Configure.js","components/DesktopExport/DesktopExport.js","containers/Main.js","serviceWorker.js","index.js"],"names":["ExportBtn","props","kind","style","disabled","onClick","export","label","saveSettings","Promise","resolve","reject","console","log","tableau","extensions","settings","saveAsync","then","newSavedSettings","catch","setSettings","type","value","settingKey","set","JSON","stringify","initializeMeta","promises","meta","dashboardContent","_dashboard","worksheets","map","worksheet","sheet","item","sheetName","name","selected","changeName","customCols","push","existingCols","modified","getSummaryDataAsync","ignoreSelection","data","columns","cols","existingNames","i","length","j","col","fieldName","dataType","indexOf","ind","k","newCol","order","getSheetColumns","all","sheetArr","sheetMeta","exportToExcel","env","filename","xlsFile","buildExcelBlob","wb","wopts","bookType","bookSST","defaultCellStyle","alignment","wrapText","vertical","horizontal","font","sz","wbout","XLSX2","write","saveAs","Blob","s2ab","s","buf","ArrayBuffer","view","Uint8Array","charCodeAt","dashboard","sheetList","XLSX","utils","book_new","columnList","tabNames","metaSheet","idx","find","columnMeta","headerOrder","colMeta","column","objCol","o","outputName","decodeDataset","rows","ws","json_to_sheet","header","baseTable","tableArray","imageAndDate","imageAndReportParams","blank","headersTable","getTableHeaders2","sheet_to_json","sheet_to_aoa","newTable","date","Date","getDate","getMonth","getFullYear","row","rowNum","colNum","sumProfit","sumSales","grandSumProfit","grandSumSales","lastCategory","range","decode_range","r","e","c","nextCell","encode_cell","v","sumProfCell","sumSalesCell","empty","grandTotal","setTableData2","getFiltersAsync","filters","filter","values","appliedValues","el","formattedValue","toString","getFilterString","fillStyle","fgColor","rgb","fontStyle","bold","fontStyleTotal","fillStyleTotal","fillStyleGrandTotal","aligmentStyle","topBorder","color","auto","styleData","border","top","fill","numFmt","addStyle2","aoa_to_sheet","table","merge","getCellMergeArray2","getWsCols2","wsrows","level","hidden","groupRows","book_append_sheet","wscols","wch","dataset","decodeRow","datasetArr","dtype","undefined","dval","_dataType","Number","isNaN","t","Extension","configure","payload","window","location","toChangeConfiguration","useEffect","initializeAsync","sheetSettings","get","parse","updateMeta","disableButton","labelSettings","replace","updateLabel","styleSettings","updateButtonStyle","filenameSettings","updateFilename","environment","context","tableauVersion","compareVersions","compare","popupUrl","origin","ui","displayDialogAsync","height","width","closePayload","error","errorCode","ErrorCodes","DialogClosedByUser","message","desktopExportHandler","useStyles","makeStyles","theme","root","heading","fontSize","typography","pxToRem","details","alignItems","flexBasis","display","lineHeight","marginBottom","group","flexDirection","fontFamily","position","stepper","strikeThrough","textDecoration","marginRight","ExpansionPanel","withStyles","boxShadow","borderBottom","margin","expanded","MuiExpansionPanel","Sheet","rename","classes","inputProps","onChange","target","onClear","placeholder","className","square","ExpansionPanelSummary","aria-controls","id","checked","select","ExpansionPanelDetails","min","max","sheets","step","pageSteps","onValueChange","changeOrder","SelectSheets","index","key","selectSheet","newPos","Column","expandIcon","Sheets","colSelect","SelectColumns","placeButtons","bottom","right","ActionButtons","resetSettings","enableButton","save","flexGrow","ConfigureTab","labelProps","filenameProps","Grid","container","xs","Fragment","marginLeft","configBody","Configure","useState","tab","switchTab","array_move","arr","old_index","new_index","splice","initializeDialogAsync","openPayload","onTabChange","selectedTabIndex","tabs","content","changeSettings","sheetIdx","colIdx","enableSave","DesktopExport","encodeURI","spacing","align","justify","Typography","component","padding","Main","labelChangedHandler","labelTxt","button","state","setState","filenameChangedHandler","changeConfiguration","isChange","toConfiguration","buttonStateChangedHandler","buttonStyleChangedHandler","metaChangedHandler","newSettings","settingsChangedHandler","settingsChanged","resetSettingsHandler","isLoading","renderExtension","renderConfigure","renderDesktopExport","this","basename","path","render","Component","Boolean","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.4bccb9dc.chunk.js","sourcesContent":["import React from 'react';\nimport { Button } from '@tableau/tableau-ui';\n\nfunction ExportBtn(props) {\n  return (\n      <div>\n         <Button kind={props.style} disabled={props.disabled} onClick={props.export}>{props.label}</Button>\n      </div>\n  );\n}\n\nexport default ExportBtn;\n","import { saveAs } from 'file-saver';\nimport XLSX from 'xlsx';\nimport XLSX2 from 'xlsx-style-rows';\n\n\n// Declare this so our linter knows that tableau is a global object\n/* global tableau */\n\nconst saveSettings = () => new Promise((resolve, reject) => {\n  console.log('[func.js] Saving settings');\n  tableau.extensions.settings.saveAsync()\n    .then(newSavedSettings => resolve(newSavedSettings))\n    .catch(reject);\n});\n\nconst setSettings = (type, value) => new Promise((resolve, reject) => {\n  console.log('[func.js] Set settings', type, value);\n  let settingKey = '';\n  switch (type) {\n    case 'sheets':\n      settingKey = 'selectedSheets';\n      break;\n    case 'label':\n      settingKey = 'buttonLabel';\n      break;\n    case 'style':\n      settingKey = 'buttonStyle';\n      break;\n    case 'filename':\n      settingKey = 'filename';\n      break;\n    default:\n      settingKey = 'selectedSheets';\n  }\n  tableau.extensions.settings.set(settingKey, JSON.stringify(value));\n  resolve();\n});\n\nconst getSheetColumns = (sheet, existingCols, modified) => new Promise((resolve, reject) => {\n  sheet.getSummaryDataAsync({ ignoreSelection: true }).then((data) => {\n    var columns = data.columns;\n    var cols = [];\n    var existingNames = [];\n    if (modified) {\n      for (var i = 0; i < existingCols.length; i++) {\n        existingNames.push(existingCols[i].name);\n      }\n      for (var j = 0; j < columns.length; j++) {\n        //console.log(columns[j]);\n        var col = {};\n        col.name = columns[j].fieldName;\n        col.dataType = columns[j].dataType;\n        col.changeName = null;\n        if (existingNames.indexOf(columns[j].fieldName) > -1) {\n          var ind = existingNames.indexOf(columns[j].fieldName);\n          col.selected = existingCols[ind].selected;\n        } else {\n          col.selected = false;\n        }\n        cols.push(col);\n      }\n    } else {\n      for (var k = 0; k < columns.length; k++) {\n        var newCol = {};\n        newCol.name = columns[k].fieldName;\n        newCol.selected = true;\n        newCol.order = k + 1;\n        cols.push(newCol);\n      }\n    }\n    resolve(cols);\n  });\n});\n\nconst initializeMeta = () => new Promise((resolve, reject) => {\n  console.log('[func.js] Initialise Meta');\n  var promises = [];\n  const worksheets = tableau.extensions.dashboardContent._dashboard.worksheets;\n\n  var meta = worksheets.map(worksheet => {\n    var sheet = worksheet;\n    var item = {};\n    item.sheetName = sheet.name;\n    item.selected = false;\n    item.changeName = null;\n    item.customCols = false;\n    promises.push(getSheetColumns(sheet, null, false));\n    return item;\n  });\n\n  console.log(`[func.js] Found ${meta.length} sheets`, meta);\n\n  Promise.all(promises).then((sheetArr) => {\n    for (var i = 0; i < sheetArr.length; i++) {\n      var sheetMeta = meta[i];\n      sheetMeta.columns = sheetArr[i];\n      meta[i] = sheetMeta;\n      console.log(`[func.js] Added ${sheetArr[i].length} columns to ${sheetMeta.sheetName}`, meta);\n    }\n    console.log(`[func.js] Meta initialised`, meta);\n    resolve(meta);\n  });\n});\n\nconst exportToExcel = (meta, env, filename) => new Promise((resolve, reject) => {\n  let xlsFile = \"export.xlsx\";\n  if (filename && filename.length > 0) {\n    xlsFile = filename + \".xlsx\";\n  }\n  buildExcelBlob(meta).then(wb => {\n    var defaultCellStyle = { alignment: { wrapText: true, vertical: \"center\", horizontal: \"center\" }, font: { sz: 11 }, };\n    var wopts = { bookType: 'xlsx', bookSST: false, type: 'binary', defaultCellStyle: defaultCellStyle };\n    var wbout = XLSX2.write(wb, wopts);\n    saveAs(new Blob([s2ab(wbout)], { type: \"\" }), xlsFile)\n    resolve();\n  });\n});\n\n\n\nfunction s2ab(s) {\n  var buf = new ArrayBuffer(s.length);\n  var view = new Uint8Array(buf);\n  for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n  return buf;\n}\n\n\n// krisd: move excel creation to caller (to support extra export to methodss)\n// callback receives a blob to save or transfer\nconst buildExcelBlob = (meta) => new Promise((resolve, reject) => {\n  console.log(\"[func.js] Got Meta\", meta);\n  // func.saveSettings(meta, function(newSettings) {\n  // console.log(\"Saved settings\", newSettings);\n  const worksheets = tableau.extensions.dashboardContent.dashboard.worksheets;\n  const wb = XLSX.utils.book_new();\n  let totalSheets = 0;\n  let sheetCount = 0;\n  const sheetList = [];\n  const columnList = [];\n  const tabNames = [];\n  for (let i = 0; i < meta.length; i++) {\n    if (meta[i].selected) {\n      sheetList.push(meta[i].sheetName);\n      tabNames.push(meta[i].changeName || meta[i].sheetName);\n      columnList.push(meta[i].columns);\n      totalSheets = totalSheets + 1;\n    }\n  }\n  sheetList.map((metaSheet, idx) => {\n    console.log(\"[func.js] Finding sheet\", metaSheet, worksheets);\n\n    const sheet = worksheets.find(s => s.name === metaSheet);\n    // eslint-disable-next-line\n\n    sheet.getSummaryDataAsync({ ignoreSelection: true }).then((data) => {\n      const columns = data.columns;\n      const columnMeta = columnList[sheetCount];\n      const headerOrder = [];\n      columnMeta.map((colMeta, idx) => {\n        if (colMeta.selected) {\n          headerOrder.push(colMeta.changeName || colMeta.name);\n        }\n        return colMeta;\n      });\n      columns.map((column, idx) => {\n        //console.log(\"[func.js] Finding column\", column.fieldName, columnMeta);\n        const objCol = columnMeta.find(o => o.name === column.fieldName);\n        if (objCol) {\n          let col = { ...column, selected: objCol.selected }\n          col.outputName = objCol.changeName || objCol.name;\n          columns[idx] = col;\n          return col;\n        } else {\n          return null;\n        }\n      });\n      //console.log(\"[func.js] Running decodeRows\", columns, data.data);\n        decodeDataset(columns, data.data)\n            .then((rows) => {\n                //console.log(\"[func.js] decodeRows returned\", rows);\n                console.log(\"[func.js] Header Order\", headerOrder);\n\n                var ws = XLSX.utils.json_to_sheet(rows, {header: headerOrder});\n\n                /*   //var sheetname = tabNames[sheetCount];\n                   // sheetCount = sheetCount + 1;\n                  //  XLSX.utils.book_append_sheet(wb, ws, sheetname);\n                   // if (sheetCount === totalSheets) {*/\n\n                var currentTable = sheet_to_aoa(ws);\n                var baseTable = getTableHeaders2(currentTable);\n                var newTable = setTableData2(ws, baseTable);\n\n\n                sheet.getFiltersAsync().then(function (filters) {\n                    filters = filters.map(function (filter) {\n                        return getFilterString(filter);\n                    });\n\n                    newTable[1][3] = filters.toString();\n\n                    ws = XLSX.utils.aoa_to_sheet(newTable);\n                    addStyle2(ws);\n                    ws['!merges'] = getCellMergeArray2(newTable);\n                    ws[\"!cols\"] = getWsCols2(newTable[0]);\n                    ws['!rows'] = groupRows(ws);\n\n                    // ws['!images'] =\n                    //     {\n                    //         name: 'image.png',\n                    //         data: 'data:image/png;base64,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',\n                    //\n                    //         opts: {base64: true},\n                    //         position: {\n                    //             type: 'twoCellAnchor',\n                    //             attrs: {editAs: 'oneCell'},\n                    //             from: {col: 1, row: 5},\n                    //             to: {col: 1, row: 6}\n                    //         }\n                    //     };\n\n                    var wb = XLSX.utils.book_new();\n                    XLSX.utils.book_append_sheet(wb, ws, \"Sheet 1\");\n                    resolve(wb);\n\n                });\n\n            });\n    });\n      return sheet;\n  });\n});\n\n\nfunction groupRows(table){\n    var wsrows = [];\n\n    var rowNum;\n\n    var range = XLSX.utils.decode_range(table['!ref']);\n\n    for (rowNum = range.s.r; rowNum <= range.e.r; rowNum++) {\n        // for (colNum = range.s.c; colNum <= range.e.c; colNum++) {\n\n        var nextCell = table[\n            XLSX.utils.encode_cell({r: rowNum, c: 0})\n            ];\n\n        if (typeof nextCell !== 'undefined') {\n            if((nextCell.v == \"Furniture\") || (nextCell.v == \"Office Supplies\") || (nextCell.v == \"Technology\")){\n                wsrows.push({level: 2, hidden: true});\n            }\n            else if((nextCell.v == \"Furniture total\") || (nextCell.v == \"Office Supplies total\") || (nextCell.v == \"Technology total\")){\n                wsrows.push({level: 1, hidden: false})\n            }\n            else if(nextCell.v == \"Grand total\"){\n                wsrows.push({level: 0, hidden: false})\n            }\n            else wsrows.push({level: 0, hidden: false})\n        }else wsrows.push({level: 0, hidden: false})\n    }\n\n    return wsrows;\n}\n\nfunction setTableData2(ws, baseTable) {\n    console.log(\"setTableData\");\n    let date = new Date();\n    baseTable[0][2] = \"Exported on: \" + date.getDate() + \"/\" + (date.getMonth()+1) + \"/\" + date.getFullYear();\n\n    baseTable[1][2] = \"Report Parameters\";\n\n    // var sumProfitIndex = tableArray[0].indexOf('SUM(Profit)');\n    // var sumSalesIndex = tableArray[0].indexOf('SUM(Sales)');\n    var sumProfit = 0;\n    var sumSales = 0;\n    var grandSumProfit = 0;\n    var grandSumSales = 0;\n    var lastCategory = null;\n    var row;\n    var rowNum;\n    var colNum;\n    var range = XLSX.utils.decode_range(ws['!ref']);\n    for(rowNum = range.s.r; rowNum <= range.e.r; rowNum++){\n        row=[];\n        for(colNum=range.s.c; colNum<=range.e.c; colNum++){\n            var nextCell = ws[\n                XLSX.utils.encode_cell({r: rowNum, c: colNum})\n                ];\n            if( typeof nextCell === 'undefined' ){\n                row.push(void 0);\n            } else{\n                row.push(nextCell.v);\n\n                if((lastCategory == null) && (rowNum > 0) && (colNum == 0))\n                    lastCategory = nextCell.v;\n                if((rowNum > 0) && (colNum == 0) && (lastCategory == nextCell.v)){\n                    let sumProfCell = ws[XLSX.utils.encode_cell({r: rowNum, c: 3})];\n                    sumProfit = sumProfit + sumProfCell.v;\n                    let sumSalesCell = ws[XLSX.utils.encode_cell({r: rowNum, c: 4})];\n                    sumSales = sumSales + sumSalesCell.v;\n                }else if ((rowNum > 0) && (colNum == 0) && (lastCategory != nextCell.v)){\n                    grandSumProfit = grandSumProfit + sumProfit;\n                    grandSumSales = grandSumSales + sumSales;\n\n                    var empty = [];\n                    empty.push(lastCategory + \" total\", \"\", \"\", sumProfit, sumSales);\n                    baseTable.push(empty);\n                    lastCategory = nextCell.v;\n\n                    let sumProfCell = ws[XLSX.utils.encode_cell({r: rowNum, c: 3})];\n                    sumProfit = sumProfCell.v;\n                    let sumSalesCell = ws[XLSX.utils.encode_cell({r: rowNum, c: 4})];\n                    sumSales = sumSalesCell.v;\n                }\n            }\n        }\n        baseTable.push(row);\n    }\n\n    var empty = [];\n    empty.push(lastCategory + \" total\", \"\", \"\", sumProfit, sumSales);\n    baseTable.push(empty);\n\n    grandSumProfit = grandSumProfit + sumProfit;\n    grandSumSales = grandSumSales + sumSales;\n    var grandTotal = [];\n    grandTotal.push(\"Grand total\", \"\", \"\", grandSumProfit, grandSumSales);\n    baseTable.push(grandTotal);\n\n    return baseTable;\n}\n\nconst getWsCols2 = (header) => {\n    var wscols = [];\n    for (var i = 0; i < header.length; i++) {  // columns length added\n        wscols.push({ wch: header[i].length + 15 })\n    }\n    return wscols;\n}\n\nfunction getCellMergeArray2(table) {\n    console.log(\"getCellMergeArray\");\n    var merge = [];\n\n    merge.push({s:{c:0, r:0}, e:{c:1, r:1}});\n\n    return merge;\n}\n\n// The func is return  a new tableArray with the 3 Categorys and headers (main category, sub category, and 3rd categoey)\nfunction getTableHeaders2(tableArray) {\n    console.log(\"getTableHeaders\");\n\n    var imageAndDate = [], imageAndReportParams = [], blank = [];\n    // Add 3 empty cells on start (for name month and full name);\n\n    for (var i = 0; i < tableArray[0].length; i++) {\n        blank.push(\"\");\n        imageAndDate.push(\"\");\n        imageAndReportParams.push(\"\");\n    }\n\n\n    // Build new Table\n    var headersTable = [imageAndDate];\n    headersTable.push(imageAndReportParams);\n    headersTable.push(blank);\n\n    return headersTable;\n}\n\nfunction addStyle2(sheet) {\n\n    var grandRow = null;\n    var rowNum;\n    var colNum;\n    var range = XLSX.utils.decode_range(sheet['!ref']);\n\n    for (rowNum = range.s.r; rowNum <= range.e.r; rowNum++) {\n        for (colNum = range.s.c; colNum <= range.e.c; colNum++) {\n\n            var nextCell = sheet[\n                XLSX.utils.encode_cell({r: rowNum, c: colNum})\n                ];\n\n            if (typeof nextCell !== 'undefined') {\n\n                var fillStyle = rowNum == 3 ? {fgColor: {rgb: \"DCE6F3\"}} : null;\n                var fontStyle = rowNum == 3 ? {bold: true} : null;\n                var fontStyleTotal = (nextCell.v == \"Furniture total\") || (nextCell.v == \"Office Supplies total\") || (nextCell.v == \"Technology total\") || (nextCell.v == \"Grand total\") ? {bold: true} : null;\n                var fillStyleTotal = rowNum > 3 ? {fgColor: {rgb: \"C4BD97\"}} : null;\n                var fillStyleGrandTotal = ((nextCell.v == \"Grand total\") || rowNum == range.e.r) ? {fgColor: {rgb: \"948A54\"}} : null;\n\n                var aligmentStyle = rowNum >= 3 ? {\n                    vertical: \"center\",\n                    horizontal: \"bottom\"\n                } : null;\n\n                var topBorder = rowNum == 2 ? {\n                    style: 'medium',\n                    color: {auto: 1}\n                } : null;\n\n\n                var styleData = {border: {}};\n                if (topBorder != null)\n                    styleData.border.top = topBorder;\n\n                if (fillStyle != null)\n                    styleData.fill = fillStyle;\n\n                if (aligmentStyle != null)\n                    styleData.alignment = aligmentStyle;\n\n                if(fontStyle != null)\n                    styleData.font = fontStyle;\n\n                if(fontStyleTotal != null)\n                    styleData.font = fontStyleTotal;\n                if(fillStyleTotal != null)\n                    styleData.fill = fillStyleTotal;\n                if(fillStyleGrandTotal != null) {\n                    styleData.fill = fillStyleGrandTotal;\n                    grandRow = rowNum;\n                }\n\n                if((rowNum > 3) && ((colNum == 3) || (colNum == 4)))\n                    styleData.numFmt = \"$#,##0.00\";\n                nextCell.s = styleData;\n            }\n        }\n    }\n    return sheet;\n}\n\nconst getWsCols = (header) => {\n  var wscols = [];\n  for (var i = 0; i < header.length; i++) {  // columns length added\n    wscols.push({ wch: header[i].length + 5 })\n  }\n  return wscols;\n}\n\n// krisd: Remove recursion to work with larger data sets\n// and translate cell data types\nconst decodeDataset = (columns, dataset) => new Promise((resolve, reject) => {\n  let promises = [];\n  for (let i = 0; i < dataset.length; i++) {\n    promises.push(decodeRow(columns, dataset[i]));\n  }\n  Promise.all(promises).then((datasetArr) => {\n    resolve(datasetArr);\n  });\n\n});\n\nconst decodeRow = (columns, row) => new Promise((resolve, reject) => {\n  let meta = {};\n  for (let j = 0; j < columns.length; j++) {\n    if (columns[j].selected) {\n      //meta[columns[j].fieldName] = thisRow[j].formattedValue;\n\n      // krisd: let's assign the sheetjs type according to the summary data column type\n      let dtype = undefined;\n      let dval = undefined;\n      switch (columns[j]._dataType) {\n        case 'int':\n        case 'float':\n          dtype = 'n';\n          dval = Number(row[j].value);  // let nums be raw w/o formatting\n          if (isNaN(dval)) dval = row[j].formattedValue;  // protect in case issue\n          break;\n        case 'date':\n        case 'date-time':\n          dtype = 's';\n          dval = row[j].formattedValue;\n          break;\n        case 'bool':\n          dtype = 'b';\n          dval = row[j].value;\n          break;\n        default:\n          dtype = 's';\n          dval = row[j].formattedValue;\n      }\n\n      let o = { v: dval, t: dtype };\n      meta[columns[j].outputName] = o;\n    }\n  }\n  resolve(meta);\n});\n\n// ----------------\n// Help func \n// ----------------\n\nlet CATEGORY = 'Category';\nlet SUB_CATEGORY = 'subCategoryName';\nlet SUB_CATEGORY_TEXT = 'Sub Category';\nlet NAME = 'name';\nlet CATEGORY_SORY_ORDER = 'CNT(CategorySortOrder)';\nlet ITEM_ORDER = 'CNT(ItemOrder)';\nlet SUB_CATEGORY_ORDER = 'MEDIAN(SubCategoryOrder)';\nlet SUM = 'SUM(value)';\nlet NAME_PROJECT = 'name (project)';\nlet COST_CENTER_NAME = 'costCenterDesc';\nlet WORKER_ID = \"id (worker_contract)\";\nlet FULL_NAME_PROJECT_NAME = \"Full Name\";\nlet Date_NAME = \"MONTH(startedAt)\"\nlet CURRENCY = \"billingCurrencyId\"\nlet HEADER_NUMBER_COL = 5;\nlet HEADER_NUMBER_ROW = 4;\n\n// Visible names\nlet TOTAL = \"Totals\";\nlet GRAND_TOTAL = \"Grand Total\";\nlet NAME_PROJECT_VISIBLE_NAME = \"Entity / Project\";\nlet COST_CENTER_VISIBLE_NAME = \"Cost Center\";\nlet WORKER_ID_VISIBLE_NAME = \"Worker ID\";\nlet FULL_NAME_VISIBLE_NAME = \"Worker Name\";\n\n\nfunction getCellMargeArray(table) {\n  console.log(\"getCellMargeArray\");\n  var marge = [];\n  var lastIndex\n  var lastString\n  var isNeedConbin\n\n  // Rows\n\n  // run only on the row until the name (all the col names)\n\n  for (var i = 1; i < HEADER_NUMBER_ROW; i++) {\n\n    // reset every start of row.\n    lastIndex = null;\n    lastString = null;\n    isNeedConbin = false;\n\n    for (var j = 1; j < table[i].length; j++) {\n      if (table[i][j] == \"\" || table[i][j] == null) {\n        lastString = table[i][j];\n        lastIndex = j;\n        continue\n      }\n      if (table[i][j] == lastString) {\n        isNeedConbin = true;\n      } else {\n        if (isNeedConbin) {\n          marge.push({ s: { r: i, c: lastIndex }, e: { r: i, c: j - 1 } });\n          isNeedConbin = false;\n        }\n        lastIndex = j;\n      }\n      lastString = table[i][j];\n    }\n\n    if (isNeedConbin) {\n      marge.push({ s: { r: i, c: lastIndex }, e: { r: i, c: j - 1 } });\n    }\n  }\n\n\n  // Cols\n\n  // run only on the col untile the fullName (widout the table data)\n  // var fullNameIndex = table[2].indexOf(FULL_NAME_PROJECT_NAME);\n\n\n  // for (var i = 0; i <= fullNameIndex; i++) {\n\n  //   // reset every start of row.\n  //   lastIndex = null;\n  //   lastString = null;\n  //   isNeedConbin = false;\n\n\n  //   for (var j = 0; j < table.length; j++) {\n  //     if (table[j][i] == \"\" || table[j][i] == null) {\n  //       lastString = table[j][i];\n  //       lastIndex = j;\n  //       continue\n  //     }\n\n\n  //     if (table[j][i] == lastString) {\n  //       isNeedConbin = true;\n  //     } else {\n  //       if (isNeedConbin) {\n  //         marge.push({ s: { r: lastIndex, c: i }, e: { r: j - 1, c: i } });\n  //         isNeedConbin = false;\n  //       }\n  //       lastIndex = j;\n  //     }\n  //     lastString = table[j][i]\n  //   }\n\n  //   if (isNeedConbin) {\n  //     marge.push({ s: { r: lastIndex, c: i }, e: { r: j - 1, c: i } });\n  //   }\n  // }\n  return marge;\n}\n\nfunction setTableData(tableArray, baseTable) {\n  console.log(\"setTableData\");\n  var projectNameIndex = tableArray[0].indexOf(NAME_PROJECT);\n  var costIndex = tableArray[0].indexOf(COST_CENTER_NAME);\n  var fullNameIndex = tableArray[0].indexOf(FULL_NAME_PROJECT_NAME);\n  var sumIndex = tableArray[0].indexOf(SUM);\n  var nameIndex = tableArray[0].indexOf(NAME);\n  var workerIDIndex = tableArray[0].indexOf(WORKER_ID);\n  var currencyIndex = tableArray[0].indexOf(CURRENCY);\n  var dateIndex = tableArray[0].indexOf(Date_NAME);\n\n  var categoryNameRow = baseTable[3].slice();\n  var projectNameSet = new Set(tableArray.map(function (value, index) { return value[projectNameIndex] }));\n\n  var projectsNames = new Set();\n  var currencyNames = new Set();\n  var dateNames = new Set();\n\n\n  var totalSum = new Array(baseTable[0].length).fill(0);\n  var globalTotalSum = new Array(baseTable[0].length).fill(0);\n\n  // all projects\n  Array.from(projectNameSet).forEach(function (name, index) {\n    var nameRows = tableArray.filter(function (row) {\n      return row[projectNameIndex] == name;\n    });\n\n    // ignor first element in array (title)\n    if (index == 0) {\n      return\n    }\n\n    // cost in the project \n    var costSetForName = new Set(nameRows.map(function (value, index) { return value[costIndex] }));\n    costSetForName.forEach(function (cost) {\n      var costRows = nameRows.filter(function (nameRow) {\n        return nameRow[costIndex] == cost;\n      });\n\n      totalSum = new Array(baseTable[0].length).fill(0);\n\n      var idSetForIdName = new Set(costRows.map(function (value, index) { return value[workerIDIndex] }));\n      Array.from(idSetForIdName).forEach(function (idName) {\n        var idNameRows = costRows.filter(function (idNameRow) {\n          return idNameRow[workerIDIndex] == idName;\n        });\n\n\n        var idSetForName = new Set(idNameRows.map(function (value, index) { return value[fullNameIndex] }));\n        Array.from(idSetForName).forEach(function (id) {\n          var idrows = idNameRows.filter(function (idRow) {\n            return idRow[fullNameIndex] == id;\n          });\n\n          let row = new Array(baseTable[0].length).fill(\"-\");\n\n          row[0] = \"\"\n          row[1] = idrows[0][projectNameIndex];\n          row[2] = idrows[0][costIndex];\n          row[3] = idrows[0][workerIDIndex] + \"\";\n          row[4] = idrows[0][fullNameIndex];\n\n          projectsNames.add(idrows[0][projectNameIndex]);\n          currencyNames.add(idrows[0][currencyIndex]);\n          dateNames.add(idrows[0][dateIndex]);\n\n          idrows.forEach(function (rowToAdd) {\n            let valueIndex = baseTable[3].indexOf(rowToAdd[nameIndex]);\n            row[valueIndex] = rowToAdd[sumIndex];\n          });\n\n          baseTable.push(row);\n\n          totalSum = totalSum.map(function (num, idx) {\n            if (row[idx] != '-') {\n              return num + row[idx];\n            }\n            return num;\n          });\n        });\n      });\n\n      globalTotalSum = globalTotalSum.map(function (totalNum, tottalIdx) {\n        return totalNum + totalSum[tottalIdx];\n      });\n\n      // Add total row \n      totalSum[0] = \"\"\n      totalSum[1] = costRows[0][projectNameIndex];\n      totalSum[2] = costRows[0][costIndex];\n      totalSum[3] = TOTAL;\n      totalSum[4] = \"\"\n      baseTable.push(totalSum);\n\n    });\n  });\n\n  // grand total \n  globalTotalSum[0] = \"\";\n  globalTotalSum[1] = \"\";\n  globalTotalSum[2] = GRAND_TOTAL;\n  globalTotalSum[3] = \"\";\n  globalTotalSum[4] = \"\";\n  baseTable.push(globalTotalSum);\n\n\n  // add category in the end\n  categoryNameRow[0] = \"\";\n  categoryNameRow[1] = \"\";\n  categoryNameRow[2] = \"\";\n  categoryNameRow[3] = \"\";\n  categoryNameRow[4] = \"\";\n  baseTable.push(categoryNameRow)\n\n  // Change date to the right format \n  let dateNamesFormat = Array.from(dateNames).map(function (dateStr) {\n    let date = new Date(dateStr);\n    const dateYear = date.getFullYear();\n    const month = date.toLocaleString('default', { month: 'short' });\n    return month + \"-\" + dateYear;\n  });\n\n  // Add table info at start\n  baseTable[0][1] = Array.from(projectsNames).join(\",\");\n  baseTable[0][2] = \"Currency: \" + Array.from(currencyNames).join(\",\");\n  baseTable[1][1] = dateNamesFormat.join(\",\");\n\n  return baseTable;\n}\n\nfunction sheet_to_aoa(sheet) {\n  console.log(\"sheet_to_aoa\");\n  return XLSX.utils.sheet_to_json(sheet, { header: 1 })\n}\n\n// The func is return  a new tableArray with the 3 Categorys and headers (main category, sub category, and 3rd categoey)\nfunction getTableHeaders(tableArray) {\n  console.log(\"getTableHeaders\");\n  // Get Index for header\n  var categoryIndex = tableArray[0].indexOf(CATEGORY);\n  var subCategoryIndex = tableArray[0].indexOf(SUB_CATEGORY);\n  var nameIndex = tableArray[0].indexOf(NAME);\n  var categoryOrderIndex = tableArray[0].indexOf(CATEGORY_SORY_ORDER);\n  var subCategoryOrderIndex = tableArray[0].indexOf(SUB_CATEGORY_ORDER);\n  var nameOrderIndex = tableArray[0].indexOf(ITEM_ORDER);\n\n  var getCategoryOrder = function (value) {\n    return (((value[categoryOrderIndex] * 1000) + value[subCategoryOrderIndex]) * 1000) + value[nameOrderIndex];\n  }\n\n  // get the 3rd Category with sort order..\n  let namesSet = tableArray.map(function (value, index) { return [value[nameIndex], getCategoryOrder(value)]; });\n  namesSet = new Set(namesSet.sort(function (a, b) { return a[1] - b[1] }).map(function (el) {\n    return el[0];\n  }));\n  namesSet = Array.from(namesSet);\n\n  // Get map Category,\n  let categoryMap = tableArray.map(function (value, index) { return [value[nameIndex], value[subCategoryIndex], value[categoryIndex]]; });\n\n  var subCategorys = [], categorys = [];\n  namesSet.forEach(function (name) {\n    let nameMap = categoryMap.find(function (element) {\n      return element[0] == name;\n    });\n    subCategorys.push(nameMap[1]);\n    categorys.push(nameMap[2]);\n  });\n\n  // Remove first item from arrays - The first item is the columns name.\n  categorys.shift();\n  subCategorys.shift();\n  namesSet.shift();\n\n  // Add 3 empty cells on start (for name month and full name);\n  categorys.unshift(\"\", \"\", \"\", \"\", CATEGORY);\n  subCategorys.unshift(\"\", \"\", \"\", \"\", SUB_CATEGORY_TEXT);\n  namesSet.unshift(\"\", NAME_PROJECT_VISIBLE_NAME, COST_CENTER_VISIBLE_NAME, WORKER_ID_VISIBLE_NAME, FULL_NAME_VISIBLE_NAME);\n\n  let blackRow = new Array(namesSet.length);\n  // Build new Table\n  var headersTable = [blackRow];\n  headersTable.push(categorys);\n  headersTable.push(subCategorys);\n  headersTable.push(namesSet);\n\n  return headersTable;\n}\n\nfunction isMainTitle(value) {\n  return [CATEGORY, SUB_CATEGORY_TEXT, FULL_NAME_VISIBLE_NAME, WORKER_ID_VISIBLE_NAME, COST_CENTER_VISIBLE_NAME, NAME_PROJECT_VISIBLE_NAME].includes(value);\n}\nfunction addStyle(sheet, table) {\n\n  var needBoarderCol = [];\n  var needBoarderRow = [];\n  var needBoarderTotalRow = [];\n  var lastRowCellString = null;\n  var lastColCellString = null;\n\n  var rowNum;\n  var colNum;\n  var grandTotalNum;\n  var range = XLSX.utils.decode_range(sheet['!ref']);\n  for (rowNum = range.s.r; rowNum <= range.e.r; rowNum++) {\n    for (colNum = range.s.c; colNum <= range.e.c; colNum++) {\n      var nextCell = sheet[\n        XLSX.utils.encode_cell({ r: rowNum, c: colNum })\n      ];\n      // the cell is fill\n      if (typeof nextCell !== 'undefined') {\n\n        // is sub category fill\n        if (rowNum == 1 && nextCell.v !== lastRowCellString && colNum >= 5) {\n          needBoarderCol.push(colNum);\n        }\n\n        if (colNum == 3 && nextCell.v == TOTAL || colNum == 2 && nextCell.v == GRAND_TOTAL) {\n          needBoarderTotalRow.push(rowNum);\n          if (nextCell.v == GRAND_TOTAL) {\n            grandTotalNum = rowNum;\n          }\n        }\n\n        if (colNum == 2 && nextCell.v !== lastColCellString) {\n          needBoarderRow.push(rowNum);\n        }\n\n        if (colNum == 2) {\n          lastColCellString = nextCell.v;\n        }\n\n        lastRowCellString = nextCell.v;\n      }\n    }\n  }\n\n  for (rowNum = range.s.r; rowNum <= range.e.r; rowNum++) {\n    for (colNum = range.s.c; colNum <= range.e.c; colNum++) {\n      var nextCell = sheet[\n        XLSX.utils.encode_cell({ r: rowNum, c: colNum })\n      ];\n\n\n\n      if (typeof nextCell !== 'undefined') {\n        var headerStyle = isMainTitle(nextCell.v) ? { fgColor: { rgb: \"f5f5f5f5\" } } : null;\n        var fillStyle = needBoarderTotalRow.includes(rowNum) && colNum > 0 ? { fgColor: { rgb: (rowNum == grandTotalNum ? \"dcdcdcdc\" : \"f5f5f5f5\") } } : headerStyle;\n        var fontStyle = needBoarderTotalRow.includes(rowNum) && colNum > 1 || isMainTitle(nextCell.v) ? { bold: true } : rowNum >= range.e.r ? { sz: 9 } : { color: { auto: 1 } };\n        var aligmentStyle = colNum <= 4 ? { vertical: \"center\", horizontal: \"bottom\"} : rowNum >= 4 && rowNum < range.e.r ? {  vertical: \"center\", horizontal: \"right\"} : { vertical: \"center\", horizontal: \"center\" };\n\n        var bottomBorder = rowNum == range.e.r && colNum >= 5 ? { style: 'medium', color: { auto: 1 } } : null;\n        var rightBorder = colNum == range.e.c ? { style: 'medium', color: { auto: 1 } } : null;\n        var topBorder = (colNum >= 5 && (rowNum > 0 && rowNum <= 3 || rowNum >= range.e.r) || isMainTitle(nextCell.v) ) ? { style: rowNum == 1 && !isMainTitle(nextCell.v) ? 'medium' : 'thin', color: { auto: 1 } } : needBoarderRow.includes(rowNum) && (rowNum > 2 && colNum > 0 || colNum > 3) ? { style: 'thin', color: { auto: 1 } } : null;\n        var leftThinBorder = colNum > 5 && rowNum <= 3 && rowNum > 0 || isMainTitle(nextCell.v) ? { style: 'thin', color: { auto: 1 } } : null;\n        var leftBorder = needBoarderCol.includes(colNum) ? { style: 'medium', color: { auto: 1 } } : leftThinBorder;\n\n        // create border:\n        var styleData = {border:{}};\n        if (bottomBorder != null) {\n          styleData.border.bottom = bottomBorder;\n        }\n        if (rightBorder != null) {\n          styleData.border.right = rightBorder;\n        }\n        if (topBorder != null) {\n          styleData.border.top = topBorder;\n        }\n        if (leftBorder != null) {\n          styleData.border.left = leftBorder;\n        }\n\n        if (fillStyle != null) {\n          styleData.fill = fillStyle;\n        }\n        styleData.font = fontStyle;\n        styleData.alignment = aligmentStyle;\n        styleData.numFmt = \"#,##0.00\";\n\n        if ( nextCell.v == '-') {\n          nextCell.t = 's';\n        }\n\n        if (colNum == 0 || rowNum <= 2 && colNum <= 3 || rowNum == range.e.r && colNum <= 4)\n          continue;\n        else\n          nextCell.s = styleData;\n      }\n    }\n  }\n  return sheet;\n}\n\nfunction getFilterString(filter) {\n  let values = filter.appliedValues.map(function (el) {\n    return el.formattedValue;\n  }).toString();\n\n  return filter.fieldName + \": \" + values;\n}\n\n// ----------------\n\nexport {\n  initializeMeta,\n  saveSettings,\n  setSettings,\n  exportToExcel,\n}","import React, { useEffect } from 'react';\nimport ExportBtn from './ExportBtn/ExportBtn';\nimport { initializeMeta, saveSettings, setSettings, exportToExcel } from '../func/func';\nimport compareVersions from 'compare-versions';\n\n// Declare this so our linter knows that tableau is a global object\n/* global tableau */\n\nfunction Extension (props) {\n\n  useEffect(() => {\n    console.log('[Extension.js] Props Changed', props);\n  }, [props]);\n\n  useEffect(() => {\n    console.log('[Extension.js] useEffect');\n    console.log('[Extension.js] Initialise Extension', props);\n    //Initialise Extension\n    tableau.extensions.initializeAsync({'configure': configure}).then(() => {\n\n      let sheetSettings = tableau.extensions.settings.get('selectedSheets');\n\n      if (sheetSettings && sheetSettings != null) {\n        console.log('[Extension.js] Existing Sheet Settings Found', JSON.parse(sheetSettings));\n        props.updateMeta(JSON.parse(sheetSettings));\n        props.disableButton(false);\n      } else {\n        console.log('[Extension.js] Can\\'t find existing sheet settings');\n        initializeMeta()\n          .then(meta => {\n            props.updateMeta(meta);\n            setSettings('sheets', meta);\n            setSettings('label', 'Export All');\n            return saveSettings();\n          })\n          .then(meta => configure(meta));\n      }\n\n      let labelSettings = tableau.extensions.settings.get('buttonLabel');\n\n      if (labelSettings && labelSettings != null) {\n        labelSettings = labelSettings.replace(/\"/g,'');\n        console.log('[Extension.js] initializeAsync Existing Label Settings Found', labelSettings);\n        props.updateLabel(labelSettings);\n      }\n\n      let styleSettings = tableau.extensions.settings.get('buttonStyle');\n\n      if (styleSettings && styleSettings != null) {\n        console.log('[Extension.js] initializeAsync Existing Label Style Found', styleSettings);\n        props.updateButtonStyle(styleSettings);\n      }\n\n      let filenameSettings = tableau.extensions.settings.get('filename');\n\n      if (filenameSettings && filenameSettings != null) {\n        console.log('[Extension.js] initializeAsync Existing Filename Found', filenameSettings);\n        props.updateFilename(filenameSettings);\n      }\n\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  function refreshSettings() {\n    let sheetSettings = tableau.extensions.settings.get('selectedSheets');\n\n    if (sheetSettings && sheetSettings != null) {\n      console.log('[Extension.js] refreshSettings Existing Sheet Settings Found. Refreshing', JSON.parse(sheetSettings));\n      props.updateMeta(JSON.parse(sheetSettings));\n      props.disableButton(false);\n    }\n\n    let labelSettings = tableau.extensions.settings.get('buttonLabel');\n\n    if (labelSettings && labelSettings != null) {\n      labelSettings = labelSettings.replace(/\"/g,'');\n      console.log('[Extension.js] refreshSettings Existing Label Settings Found', labelSettings);\n      props.updateLabel(labelSettings);\n    }\n\n    let styleSettings = tableau.extensions.settings.get('buttonStyle');\n\n    if (styleSettings && styleSettings != null) {\n      console.log('[Extension.js] refreshSettings Existing Label Style Found', styleSettings);\n      props.updateButtonStyle(styleSettings);\n    }\n\n    let filenameSettings = tableau.extensions.settings.get('filename');\n\n    if (filenameSettings && filenameSettings != null) {\n      console.log('[Extension.js] refreshSettings Existing Filename Found', filenameSettings);\n      props.updateFilename(filenameSettings);\n    }\n  }\n\n  function configure (meta) {\n    let payload = '';\n    if (meta) {\n      payload = JSON.stringify(meta);\n    }\n    console.log(props);\n    \n    console.log('[Extension.js] configure Sending payload', payload);\n    const popupUrl = `${window.location}/configure`;\n    props.toChangeConfiguration(true);\n    // tableau.extensions.ui.displayDialogAsync(popupUrl, payload, { height: 500, width: 500 }).then((closePayload) => {\n    //   refreshSettings();\n    //   console.log('[Extension.js] Config window closed', props)\n    // }).catch((error) => {\n    //   switch(error.errorCode) {\n    //     case tableau.ErrorCodes.DialogClosedByUser:\n    //       console.log('[Extension.js] Dialog was closed by user');\n    //       refreshSettings();\n    //       console.log('[Extension.js] Config window closed', props);\n    //       break;\n    //     default:\n    //       console.error('[Extension.js]', error.message);\n    //   }\n    // });\n  }\n\n  function clickExportHandler() {\n    if (tableau.extensions.environment.context === \"server\") {\n      exportToExcel(props.meta, 'server', props.filename);\n    } else {\n\t\t\tconsole.log('[Extension.js] Tableau Version', tableau.extensions.environment.tableauVersion);\n      if (compareVersions.compare(tableau.extensions.environment.tableauVersion, '2019.4.0', '>=') ) {\n\t\t\t\texportToExcel(props.meta, 'desktop', props.filename);\n\t\t\t} else {\n\t\t\t\tdesktopExportHandler ();\n\t\t\t}\n\n    }\n  }\n\n  function desktopExportHandler () {\n    const popupUrl = `${window.location.origin}/desktopexport`;\n    tableau.extensions.ui.displayDialogAsync(popupUrl, '', { height: 350, width: 400 }).then((closePayload) => {\n      console.log('[Extension.js] Export window closed')\n    }).catch((error) => {\n      switch(error.errorCode) {\n        case tableau.ErrorCodes.DialogClosedByUser:\n          console.log('[Extension.js] Export window was closed by user');\n          break;\n        default:\n          console.error('[Extension.js]', error.message);\n      }\n    });\n  }\n\n  return (\n    <ExportBtn label={props.label} style={props.style} disabled={props.disabled} export={clickExportHandler}></ExportBtn>\n  );\n}\n\nexport default Extension;\n","import React from 'react';\nimport { Checkbox, TextField, Stepper } from '@tableau/tableau-ui';\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\nimport MuiExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: '100%',\n  },\n  heading: {\n    fontSize: theme.typography.pxToRem(15),\n  },\n  details: {\n    alignItems: 'center',\n  },\n  column: {\n    flexBasis: '50%',\n  },\n  label: {\n    display: 'block',\n    fontSize: 10,\n    lineHeight: '10px',\n    order: 0,\n    marginBottom: 3,\n  },\n  group: {\n    color: 'rgba(0, 0, 0, 0.56)',\n    display: 'inline-flex',\n    flexDirection: 'column',\n    fontFamily: 'Benton Sans, Arial, Helvetica, sans-serif',\n    position: 'relative',\n  },\n  stepper: {\n    marginBottom: 13\n  },\n  strikeThrough: {\n    textDecoration: 'line-through',\n    marginRight: 5,\n    color: 'rgba(156, 156, 156, 0.8)',\n  }\n}));\n\nconst ExpansionPanel = withStyles({\n  root: {\n    boxShadow: 'none',\n    '&:not(:last-child)': {\n      borderBottom: 0,\n    },\n    '&:before': {\n      display: 'none',\n    },\n    '&$expanded': {\n      margin: 'auto',\n    },\n  },\n  expanded: {},\n})(MuiExpansionPanel);\n\nfunction Sheet(props) {\n\n  const classes = useStyles();\n\n  const inputProps = {\n    label: 'Rename',\n    onChange: e => props.changeName(e.target.value),\n    onClear: () => {\n      props.changeName(null);\n    },\n    placeholder: props.name || 'Override Export Tab Name',\n    style: { width: 200 },\n    value: props.rename || '',\n  };\n\n  function renderSheetName(name, rename) {\n    if (rename) {\n      return (\n        <div>\n          <span className={classes.strikeThrough}>{name}</span>\n          <span>{rename}</span>\n        </div>\n      )\n    }\n    return (\n      <div>{name}</div>\n    )\n  }\n\n  return (\n    <div className={classes.root}>\n      <ExpansionPanel square expanded={props.selected}>\n        <ExpansionPanelSummary\n          aria-controls=\"panel1c-content\"\n          id=\"panel1c-header\"\n        >\n          <div>\n            <Checkbox checked={props.selected} onChange={props.select}>{renderSheetName(props.name, props.rename)}</Checkbox>\n          </div>\n        </ExpansionPanelSummary>\n        <ExpansionPanelDetails className={classes.details}>\n          <div className={classes.column}>\n            <TextField {...inputProps} />\n          </div>\n          <div className={classes.column}>\n            <div className={classes.group}>\n              <label className={classes.label}>Change Order</label>\n              <Stepper min={1} max={props.sheets.length} step={1} pageSteps={1} value={props.id + 1} onValueChange={value => props.changeOrder(value)} className={classes.stepper} />\n            </div>\n          </div>\n        </ExpansionPanelDetails>\n      </ExpansionPanel>\n    </div>\n  );\n\n}\n\nexport default Sheet;\n","import React from 'react';\nimport Sheet from './Sheet/Sheet'\n\nfunction SelectSheets(props) {\n\n  if (props && props.sheets) {\n    return props.sheets.map((sheet, index) => {\n      return (\n        <Sheet\n          id={index}\n          key={sheet.sheetName}\n          name={sheet.sheetName}\n          rename={sheet.changeName}\n          sheets={props.sheets}\n          selected={sheet.selected}\n          select={() => props.selectSheet(index)}\n          changeName={(name) => props.changeName(index,name)}\n          changeOrder={(newPos) => props.changeOrder(index,newPos)}\n          />\n      );\n    });\n  } else {\n    return (\n      <div></div>\n    )\n  }\n\n}\n\nexport default SelectSheets;\n","import React from 'react';\nimport { Checkbox, TextField, Stepper } from '@tableau/tableau-ui';\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\nimport MuiExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: '100%',\n  },\n  heading: {\n    fontSize: theme.typography.pxToRem(15),\n  },\n  details: {\n    alignItems: 'center',\n  },\n  column: {\n    flexBasis: '50%',\n  },\n  label: {\n    display: 'block',\n    fontSize: 10,\n    lineHeight: '10px',\n    order: 0,\n    marginBottom: 3,\n  },\n  group: {\n    color: 'rgba(0, 0, 0, 0.56)',\n    display: 'inline-flex',\n    flexDirection: 'column',\n    fontFamily: 'Benton Sans, Arial, Helvetica, sans-serif',\n    position: 'relative',\n  },\n  stepper: {\n    marginBottom: 13\n  },\n  strikeThrough: {\n    textDecoration: 'line-through',\n    color: 'rgba(156, 156, 156, 0.8)',\n    marginRight: 5,\n  }\n}));\n\nconst ExpansionPanel = withStyles({\n  root: {\n    boxShadow: 'none',\n    '&:not(:last-child)': {\n      borderBottom: 0,\n    },\n    '&:before': {\n      display: 'none',\n    },\n    '&$expanded': {\n      margin: 'auto',\n    },\n  },\n  expanded: {},\n})(MuiExpansionPanel);\n\nfunction Column(props) {\n\n  const classes = useStyles();\n\n  const inputProps = {\n    label: 'Rename',\n    onChange: e => props.changeName(e.target.value),\n    onClear: () => {\n      props.changeName(null);\n    },\n    placeholder: props.name || 'Override Export Column Name',\n    style: { width: 200 },\n    value: props.rename || '',\n  };\n\n  function renderColName(name, rename) {\n    if (rename) {\n      return (\n        <div>\n          <span className={classes.strikeThrough}>{name}</span>\n          <span>{rename}</span>\n        </div>\n      )\n    }\n    return (\n      <div>{name}</div>\n    )\n  }\n\n  return (\n    <div className={classes.root}>\n      <ExpansionPanel square>\n        <ExpansionPanelSummary\n          expandIcon={<ExpandMoreIcon />}\n          aria-controls=\"panel1c-content\"\n          id=\"panel1c-header\"\n        >\n          <div>\n            <Checkbox checked={props.selected} onChange={props.select}>{renderColName(props.name, props.rename)}</Checkbox>\n          </div>\n        </ExpansionPanelSummary>\n        <ExpansionPanelDetails className={classes.details}>\n          <div className={classes.column}>\n            <TextField {...inputProps} />\n          </div>\n          <div className={classes.column}>\n            <div className={classes.group}>\n              <label className={classes.label}>Change Order</label>\n              <Stepper min={1} max={props.cols.length} step={1} pageSteps={1} value={props.id + 1} onValueChange={value => props.changeOrder(value)} className={classes.stepper} />\n            </div>\n          </div>\n        </ExpansionPanelDetails>\n      </ExpansionPanel>\n    </div>\n  );\n\n}\n\nexport default Column;\n","import React from 'react';\nimport Column from './Column/Column'\n\nfunction Sheets(props) {\n\n  if (props && props.cols) {\n    return props.cols.map((col, index) => {\n      return (\n        <Column\n          id={index}\n          key={col.name}\n          name={col.name}\n          rename={col.changeName}\n          selected={col.selected}\n          select={() => props.colSelect(props.id, index)}\n          changeName={(name) => props.changeName(props.id, index, name)}\n          cols={props.cols}\n          changeOrder={(newPos) => props.changeOrder(props.id, index, newPos)}\n          />\n      );\n    });\n  } else {\n    return (\n      <div></div>\n    )\n  }\n\n}\n\nexport default Sheets;\n","import React from 'react';\nimport Sheet from './Sheet/Sheet'\n\nfunction SelectColumns(props) {\n\n  if (props && props.sheets) {\n    return props.sheets.map((sheet, index) => {\n      if (sheet.selected) {\n        return (\n          <div key={sheet.sheetName}>\n            <div><b>{sheet.sheetName}</b></div>\n            <Sheet\n              id={index}\n              name={sheet.sheetName}\n              cols={sheet.columns}\n              colSelect={props.colSelect}\n              changeName={props.changeName}\n              changeOrder={props.changeOrder}\n              />\n          </div>\n        );\n      } else {\n        return (\n          <div key={sheet.sheetName}></div>\n        )\n      }\n    });\n  } else {\n    return (\n      <div></div>\n    )\n  }\n\n}\n\nexport default SelectColumns;\n","import React from 'react';\nimport { Button } from '@tableau/tableau-ui';\n\nconst placeButtons = {\n  bottom: 10,\n  right: 10,\n  position: 'fixed'\n}\n\nfunction ActionButtons(props) {\n\n  return (\n    <div style={placeButtons}>\n      <Button kind={'outline'} style={{marginRight: 12}} onClick={props.resetSettings}>Reset</Button>\n      <Button kind={'primary'} style={{marginRight: 12}} disabled={!props.enableButton} onClick={props.save}>Save Changes</Button>\n    </div>\n  )\n\n}\n\nexport default ActionButtons;\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport { TextField, DropdownSelect } from '@tableau/tableau-ui';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n  },\n}));\n\nfunction ConfigureTab(props) {\n  const classes = useStyles();\n\n  const labelProps = {\n    label: 'Button Label',\n    onChange: e => {\n      console.log('[ConfigureTab.js] Updating Button Label',e.target.value)\n      props.updateLabel(e.target.value)\n    },\n    onClear: () => {\n      props.updateLabel('Export All');\n    },\n    placeholder: 'Button Label',\n    style: { width: 400 },\n    value: props.label || '',\n  };\n\n  const filenameProps = {\n    label: 'Export Filename',\n    onChange: e => props.updateFilename(JSON.stringify(e.target.value)),\n    onClear: () => {\n      props.updateFilename('ExportAll');\n    },\n    placeholder: 'Export Filename',\n    style: { width: 400 },\n    value: props.filename || '',\n  };\n\n  const styleDropDown = {\n    marginLeft: 10\n  }\n\n  return (\n    <div className={classes.root}>\n      <Grid container>\n        <Grid item xs={12}>\n          <TextField {...labelProps} />\n        </Grid>\n        <Grid item xs={12}>\n          <TextField {...filenameProps} />\n        </Grid>\n        <Grid item xs={12}>\n          <React.Fragment>\n            Set Button Style to:\n            <DropdownSelect kind='line' value={props.style} onChange={e => props.updateButtonStyle(JSON.stringify(e.target.value))} style={styleDropDown}>\n              <option>outline</option>\n              <option>primary</option>\n              <option>destructive</option>\n            </DropdownSelect>\n          </React.Fragment>\n        </Grid>\n      </Grid>\n    </div>\n  )\n\n}\n\nexport default ConfigureTab;\n","import React, { useState, useEffect } from 'react';\nimport { Tabs } from '@tableau/tableau-ui';\nimport SelectSheets from './SelectSheets/SelectSheets';\nimport SelectColumns from './SelectColumns/SelectColumns';\nimport ActionButtons from './ActionButtons/ActionButtons';\nimport ConfigureTab from './ConfigureTab/ConfigureTab';\nimport { saveSettings, setSettings } from '../func/func';\nimport './Configure.css';\n\n// Declare this so our linter knows that tableau is a global object\n/* global tableau */\n\nconst configBody = {\n  height: 'calc(100vh - 170px)',\n}\n\nconst logoBanner = {\n  backgroundColor: 'rgb(245, 245, 245)',\n  height: 26,\n  paddingTop: 12,\n  paddingBottom: 12,\n  paddingLeft: 18,\n}\n\nfunction Configure(props) {\n  const [tab, switchTab] = useState(0);\n  const tabs = [ { content: 'Select Sheets'}, { content: 'Select Columns' }, { content: 'Configure' } ];\n\n  console.log('[Configure.js] Initialise Config Screen', props);\n\n  useEffect(() => {\n    console.log('[Configure.js] useEffect');\n    //Initialise Extension\n    tableau.extensions.initializeDialogAsync().then((openPayload) => {\n\n      console.log('[Configure.js] Initialise Dialog', openPayload);\n\n      let sheetSettings = tableau.extensions.settings.get('selectedSheets');\n\n      if (sheetSettings && sheetSettings != null) {\n        console.log('[Configure.js] Existing Sheet Settings Found', sheetSettings);\n        props.updateMeta(JSON.parse(sheetSettings));\n      }\n\n      let labelSettings = tableau.extensions.settings.get('buttonLabel');\n\n      if (labelSettings && labelSettings != null) {\n        labelSettings = labelSettings.replace(/\"/g,'');\n        console.log('[Configure.js] initializeDialogAsync Existing Label Settings Found', labelSettings);\n        props.updateLabel(labelSettings);\n      }\n\n      let styleSettings = tableau.extensions.settings.get('buttonStyle');\n\n      if (styleSettings && styleSettings != null) {\n        console.log('[Configure.js] initializeDialogAsync Existing Label Style Found', styleSettings);\n        props.updateButtonStyle(styleSettings);\n      }\n\n      let filenameSettings = tableau.extensions.settings.get('filename');\n\n      if (filenameSettings && filenameSettings != null) {\n        console.log('[Configure.js] initializeDialogAsync Existing Filename Found', filenameSettings);\n        props.updateFilename(filenameSettings);\n      }\n\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  function selectSheetHandler(i) {\n    console.log('[Configure.js] selectSheetHandler', i);\n    const meta = props.meta;\n    meta[i].selected = !meta[i].selected;\n    props.updateMeta(meta);\n    props.changeSettings(true);\n  }\n\n  function selectColumnHandler(sheetIdx, colIdx) {\n    console.log('[Configure.js] selectColumnHandler', sheetIdx, colIdx);\n    const meta = props.meta;\n    const sheet = meta[sheetIdx];\n    sheet.columns[colIdx].selected = !sheet.columns[colIdx].selected;\n    meta[sheetIdx] = sheet;\n    props.updateMeta(meta);\n    props.changeSettings(true);\n  }\n\n  function changeSheetNameHandler(i, name) {\n    console.log('[Configure.js] changeSheetNameHandler', i, name);\n    const meta = props.meta;\n    meta[i].changeName = name;\n    props.updateMeta(meta);\n    props.changeSettings(true);\n  }\n\n  function changeColumnNameHandler(sheetIdx, colIdx, name) {\n    console.log('[Configure.js] changeColumnNameHandler', sheetIdx, colIdx, name);\n    const meta = props.meta;\n    const sheet = meta[sheetIdx];\n    sheet.columns[colIdx].changeName = name;\n    meta[sheetIdx] = sheet;\n    props.updateMeta(meta);\n    props.changeSettings(true);\n  }\n\n  function array_move(arr, old_index, new_index) {\n    if (new_index >= arr.length) {\n        var k = new_index - arr.length + 1;\n        while (k--) {\n            arr.push(undefined);\n        }\n    }\n    arr.splice(new_index, 0, arr.splice(old_index, 1)[0]);\n    return arr; // for testing\n  };\n\n  function changeSheetOrderHandler(i, newPos) {\n    console.log('[Configure.js] changeSheetOrderHandler', i, newPos);\n    if (newPos > 0) {\n      const meta = array_move(props.meta, i, newPos - 1);\n      props.updateMeta(meta);\n      props.changeSettings(true);\n    }\n  }\n\n  function changeColumnOrderHandler(sheetIdx, colIdx, newPos) {\n    console.log('[Configure.js] changeColumnOrderHandler', sheetIdx, colIdx, newPos);\n    if (newPos > 0) {\n      const meta = props.meta;\n      const sheet = meta[sheetIdx];\n      const columns = array_move(sheet.columns, colIdx, newPos - 1);\n      meta[sheetIdx].columns = columns;\n      props.updateMeta(meta);\n      props.changeSettings(true);\n    }\n  }\n\n  function updateLabelHandler(label) {\n    console.log('[Configure.js] changeUpdateLabelHandler', label);\n    props.updateLabel(label);\n    props.changeSettings(true);\n  }\n\n  function updateButtonStyleHandler(style) {\n    console.log('[Configure.js] changeLabelStyleHandler', style);\n    props.updateButtonStyle(style);\n    props.changeSettings(true);\n  }\n\n  function updateFilenameHandler(filename) {\n    console.log('[Configure.js] updateFilenameHandler', filename);\n    props.updateFilename(filename);\n    props.changeSettings(true);\n  }\n\n  function saveSettingsHandler() {\n    console.log('[Configure.js] saveSettingsHandler - Saving Settings', props);\n    const meta = props.meta;\n    const label = props.label;\n    const style = props.style;\n    const filename = props.filename;\n    props.toChangeConfiguration(false);\n    props.disableButton(false);\n    setSettings('sheets', meta)\n      .then(setSettings('label', label))\n      .then(setSettings('style', style))\n      .then(setSettings('filename', filename))\n      .then(saveSettings())\n      .then(props.changeSettings(false))\n  }\n\n  function resetSettingsHandler() {\n    console.log('[Configure.js] resetSettingsHandler - Reset Settings');\n    props.resetSettings();\n  }\n\n  return (\n      <div>\n      <Tabs\n        onTabChange={(index) => {\n          switchTab(index);\n        }}\n        selectedTabIndex={tab}\n        tabs={tabs}\n        ><div style={configBody}>\n          { tab === 0 ? <SelectSheets sheets={props.meta} selectSheet={selectSheetHandler} changeOrder={changeSheetOrderHandler} changeName={changeSheetNameHandler} /> : null }\n          { tab === 1 ? <SelectColumns sheets={props.meta} colSelect={selectColumnHandler} changeName={changeColumnNameHandler} changeOrder={changeColumnOrderHandler}/> : null }\n          { tab === 2 ? <ConfigureTab label={props.label} filename={props.filename} style={props.style} updateLabel={updateLabelHandler} updateButtonStyle={updateButtonStyleHandler} updateFilename={updateFilenameHandler}/> : null }\n        </div>\n      </Tabs>\n      <ActionButtons enableButton={props.enableSave} save={saveSettingsHandler} resetSettings={resetSettingsHandler} />\n      </div>\n  );\n}\n\nexport default Configure;\n","import React, { useEffect } from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport './DesktopExport.css';\n// import { exportToExcel } from '../func/func';\n\n// Declare this so our linter knows that tableau is a global object\n/* global tableau */\n\nfunction DesktopExport() {\n\n  console.log('[DesktopExport.js] Initialise Export Screen');\n\n  const emailMessage = `Hi Michael,\n\nI'm such a huge fan of the Export All extension created by Craig Bloodworth. Trouble is my users make use of Tableau Desktop just as much as Server and I really want them to feel the same love for all things data in Excel. Please please please please enable the downloads API in extensions. It would make such a huge difference to my Tableau life. I promise I won't export all my data, just the important stuff.\n\nThanks so much for your time and helping to build an amazing product!`;\n\n  const encodedMessage = encodeURI(emailMessage);\n  const hrefEncoded = 'mailto:mkovner@tableau.com?cc=craig.bloodworth@theinformationlab.co.uk&subject=Please%20Enable%20Downloads%20in%20Desktop%20Extensions&body=' + encodedMessage;\n\n  useEffect(() => {\n    console.log('[DesktopExport.js] useEffect');\n    //Initialise Extension\n    tableau.extensions.initializeDialogAsync().then((openPayload) => {\n\n      console.log('[DesktopExport.js] Initialise Dialog', openPayload);\n\n      let sheetSettings = tableau.extensions.settings.get('selectedSheets');\n\n      if (sheetSettings && sheetSettings != null) {\n        // console.log('[DesktopExport.js] Existing Sheet Settings Found', sheetSettings);\n        // const meta = JSON.parse(sheetSettings);\n        // exportToExcel(meta, 'desktop')\n        //   .then((blob) => {\n        //     navigator.webkitPersistentStorage.requestQuota (\n        //         blob.byteLength, function(grantedBytes) {\n        //             window.webkitRequestFileSystem(window.PERSISTENT, grantedBytes, onInitFs, handleError);\n        //\n        //         }, function(e) { console.log('Error', e); }\n        //     );\n        //   });\n      }\n\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <Grid\n      container\n      spacing={0}\n      align=\"left\"\n      justify=\"center\"\n    >\n      <Grid item>\n        <Typography component=\"div\" style={{padding: 20}}>\n          <p>Hi There!</p>\n          <p>It looks like you're trying to create the Excel file using a desktop version earlier than 2019.4. Unfortunately you {\"can't\"} as the download function is disabled, however there are two solutions. Either publish your dashboard to Server where the Excel file will download as expected, or upgrade your copy of Desktop to 2019.4 or greater.</p>\n          <p>To those who've previously emailed Tableau to request they enable the download feature...we did it!! Thank you so much for taking the time to present the case, I {\"can't\"} believe how many emails you sent. {\"I'm\"} humbled.</p>\n          <p>Craig</p>\n        </Typography>\n      </Grid>\n    </Grid>\n  );\n}\n\nexport default DesktopExport;\n","import React, { Component, Menu, MenuItem } from 'react';\nimport { BrowserRouter, Route, Link, Redirect } from 'react-router-dom';\nimport Extension from '../components/Extension/Extension';\nimport Configure from '../components/Configure/Configure';\nimport DesktopExport from '../components/DesktopExport/DesktopExport';\nimport './Main.css';\n\nclass Main extends Component {\n\n  constructor(props) {\n    console.log('[Main.js] constructor');\n    super(props);\n    this.state = {\n      toConfiguration: false,\n      meta: undefined,\n      button: {\n        label: 'Export All',\n        style: 'outline',\n        disabled: true\n      },\n      isLoading: false,\n      filename: 'ExportAll',\n      settingsChanged: false,\n    };\n    console.log('[Main.js] state initialised', this.state);\n  }\n\n  componentWillMount() {\n    console.log('[Main.js] componentWillMount');\n  }\n\n  componentDidMount() {\n    console.log('[Main.js] componentDidMount');\n  }\n\n  labelChangedHandler = (labelTxt) => {\n    console.log(`[Main.js] Updating label text to ${labelTxt}`);\n    const button = { ...this.state.button, label: labelTxt };\n    this.setState({ button });\n  }\n\n  filenameChangedHandler = (filename) => {\n    console.log(`[Main.js] Updating filename to ${JSON.parse(filename)}`);\n    this.setState({ filename: JSON.parse(filename) });\n  }\n\n  changeConfiguration = (isChange) => {\n    console.log(`[Main.js] changeToconConfiguration ${isChange}`);\n    this.setState({ toConfiguration: isChange });\n  }\n  buttonStateChangedHandler = (disabled) => {\n    console.log(`[Main.js] Changing button state to ${disabled}`);\n    const button = { ...this.state.button, disabled };\n    this.setState({ button });\n  }\n\n  buttonStyleChangedHandler = (style) => {\n    console.log(`[Main.js] Changing button style to ${style}`);\n    const button = { ...this.state.button, style: JSON.parse(style) };\n    this.setState({ button });\n  }\n\n  metaChangedHandler = (newSettings) => {\n    console.log('[Main.js] Meta changed', newSettings);\n    this.setState({ meta: newSettings });\n  }\n\n  settingsChangedHandler = (state) => {\n    console.log('[Main.js] Settings changed');\n    this.setState({ settingsChanged: state });\n  }\n\n  resetSettingsHandler = () => {\n    console.log('[Main.js] Reset Settings');\n    this.setState({\n      meta: undefined,\n      button: {\n        label: 'Export All',\n        style: 'outline',\n        disabled: true\n      },\n      isLoading: false,\n      filename: 'ExportAll',\n      settingsChanged: false,\n    });\n  }\n\n  renderExtension = () => {\n    return (\n      <Extension label={this.state.button.label} meta={this.state.meta} style={this.state.button.style} toChangeConfiguration={this.changeConfiguration} filename={this.state.filename} disabled={this.state.button.disabled} updateMeta={this.metaChangedHandler} disableButton={this.buttonStateChangedHandler} updateLabel={this.labelChangedHandler} updateButtonStyle={this.buttonStyleChangedHandler} updateFilename={this.filenameChangedHandler} />\n    )\n  }\n\n  renderConfigure = () => {\n    return (\n      <Configure label={this.state.button.label} meta={this.state.meta} style={this.state.button.style} filename={this.state.filename} enableSave={this.state.settingsChanged} updateMeta={this.metaChangedHandler} disableButton={this.buttonStateChangedHandler} toChangeConfiguration={this.changeConfiguration} updateLabel={this.labelChangedHandler} changeSettings={this.settingsChangedHandler} updateButtonStyle={this.buttonStyleChangedHandler} updateFilename={this.filenameChangedHandler} resetSettings={this.resetSettingsHandler} />\n    )\n  }\n\n  renderDesktopExport = () => {\n    return (\n      <DesktopExport />\n    )\n  }\n\n  render() {\n\n    if(this.state.toConfiguration) {\n      return (\n        <BrowserRouter basename=\"/Tableau-Extension-Export-Naya/build/\">\n           {/* <Link to='/configure'>configure</Link> */}\n          <Route path=\"/\" render={this.renderConfigure} />\n          {/* <Route path=\"/configure\" render={this.renderConfigure} /> */}\n          {/* <Route path=\"/desktopexport\" render={this.renderDesktopExport} /> */}\n        </BrowserRouter>\n      );\n    }\n\n    return (\n      <BrowserRouter basename=\"/Tableau-Extension-Export-Naya/build/\">\n        <Route path=\"/\" render={this.renderExtension} />\n        <Route path=\"/configure\" render={this.renderConfigure} />\n        <Route path=\"/desktopexport\" render={this.renderDesktopExport} />\n      </BrowserRouter>\n    );\n  }\n}\n\nexport default Main;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (!process.env.PUBLIC_URL && process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import 'react-app-polyfill/ie11';\nimport 'react-app-polyfill/stable';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Main from './containers/Main';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<Main />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}