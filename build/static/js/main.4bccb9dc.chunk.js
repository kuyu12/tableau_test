(this["webpackJsonptableau-extension-exportall"]=this["webpackJsonptableau-extension-exportall"]||[]).push([[0],{244:function(e,t){},311:function(e,t,n){e.exports=n(637)},517:function(e,t,n){},522:function(e,t){},523:function(e,t){},546:function(e,t){},548:function(e,t){},584:function(e,t){},585:function(e,t){},633:function(e,t,n){},634:function(e,t,n){},635:function(e,t,n){},637:function(e,t,n){"use strict";n.r(t);n(312),n(321);var a=n(0),o=n.n(a),l=n(64),r=n.n(l),i=(n(517),n(124)),s=n(294),c=n(295),u=n(302),d=n(296),g=n(303),m=n(179),f=n(65),h=n(23);var p=function(e){return o.a.createElement("div",null,o.a.createElement(h.Button,{kind:e.style,disabled:e.disabled,onClick:e.export},e.label))},b=n(297),v=n(20),y=n.n(v),E=n(177),x=n.n(E);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var C=function(){return new Promise((function(e,t){console.log("[func.js] Saving settings"),tableau.extensions.settings.saveAsync().then((function(t){return e(t)})).catch(t)}))},j=function(e,t){return new Promise((function(n,a){console.log("[func.js] Set settings",e,t);var o="";switch(e){case"sheets":o="selectedSheets";break;case"label":o="buttonLabel";break;case"style":o="buttonStyle";break;case"filename":o="filename";break;default:o="selectedSheets"}tableau.extensions.settings.set(o,JSON.stringify(t)),n()}))},O=function(){return new Promise((function(e,t){console.log("[func.js] Initialise Meta");var n=[],a=tableau.extensions.dashboardContent._dashboard.worksheets.map((function(e){var t=e,a={};return a.sheetName=t.name,a.selected=!1,a.changeName=null,a.customCols=!1,n.push(function(e,t,n){return new Promise((function(a,o){e.getSummaryDataAsync({ignoreSelection:!0}).then((function(e){var o=e.columns,l=[],r=[];if(n){for(var i=0;i<t.length;i++)r.push(t[i].name);for(var s=0;s<o.length;s++){var c={};if(c.name=o[s].fieldName,c.dataType=o[s].dataType,c.changeName=null,r.indexOf(o[s].fieldName)>-1){var u=r.indexOf(o[s].fieldName);c.selected=t[u].selected}else c.selected=!1;l.push(c)}}else for(var d=0;d<o.length;d++){var g={};g.name=o[d].fieldName,g.selected=!0,g.order=d+1,l.push(g)}a(l)}))}))}(t,null,!1)),a}));console.log("[func.js] Found ".concat(a.length," sheets"),a),Promise.all(n).then((function(t){for(var n=0;n<t.length;n++){var o=a[n];o.columns=t[n],a[n]=o,console.log("[func.js] Added ".concat(t[n].length," columns to ").concat(o.sheetName),a)}console.log("[func.js] Meta initialised",a),e(a)}))}))},w=function(e,t,n){return new Promise((function(t,a){var o="export.xlsx";n&&n.length>0&&(o=n+".xlsx"),k(e).then((function(e){var n={bookType:"xlsx",bookSST:!1,type:"binary",defaultCellStyle:{alignment:{wrapText:!0,vertical:"center",horizontal:"center"},font:{sz:11}}},a=x.a.write(e,n);Object(b.saveAs)(new Blob([N(a)],{type:""}),o),t()}))}))};function N(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!=e.length;++a)n[a]=255&e.charCodeAt(a);return t}var k=function(e){return new Promise((function(t,n){console.log("[func.js] Got Meta",e);for(var a=tableau.extensions.dashboardContent.dashboard.worksheets,o=(y.a.utils.book_new(),[]),l=[],r=[],s=0;s<e.length;s++)e[s].selected&&(o.push(e[s].sheetName),r.push(e[s].changeName||e[s].sheetName),l.push(e[s].columns),1);o.map((function(e,n){console.log("[func.js] Finding sheet",e,a);var o=a.find((function(t){return t.name===e}));return o.getSummaryDataAsync({ignoreSelection:!0}).then((function(e){var n=e.columns,a=l[0],r=[];a.map((function(e,t){return e.selected&&r.push(e.changeName||e.name),e})),n.map((function(e,t){var o=a.find((function(t){return t.name===e.fieldName}));if(o){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{selected:o.selected});return l.outputName=o.changeName||o.name,n[t]=l,l}return null})),H(n,e.data).then((function(e){console.log("[func.js] Header Order",r);var n=y.a.utils.json_to_sheet(e,{header:r}),a=function(e){console.log("getTableHeaders");for(var t=[],n=[],a=[],o=0;o<e[0].length;o++)a.push(""),t.push(""),n.push("");var l=[t];return l.push(n),l.push(a),l}(function(e){return console.log("sheet_to_aoa"),y.a.utils.sheet_to_json(e,{header:1})}(n)),l=function(e,t){console.log("setTableData");var n=new Date;t[0][2]="Exported on: "+n.getDate()+"/"+(n.getMonth()+1)+"/"+n.getFullYear(),t[1][2]="Report Parameters";var a,o,l,r=0,i=0,s=0,c=0,u=null,d=y.a.utils.decode_range(e["!ref"]);for(o=d.s.r;o<=d.e.r;o++){for(a=[],l=d.s.c;l<=d.e.c;l++){var g=e[y.a.utils.encode_cell({r:o,c:l})];if("undefined"===typeof g)a.push(void 0);else if(a.push(g.v),null==u&&o>0&&0==l&&(u=g.v),o>0&&0==l&&u==g.v){var m=e[y.a.utils.encode_cell({r:o,c:3})];r+=m.v;var f=e[y.a.utils.encode_cell({r:o,c:4})];i+=f.v}else if(o>0&&0==l&&u!=g.v){var h;s+=r,c+=i,(h=[]).push(u+" total","","",r,i),t.push(h),u=g.v;var p=e[y.a.utils.encode_cell({r:o,c:3})];r=p.v;var b=e[y.a.utils.encode_cell({r:o,c:4})];i=b.v}}t.push(a)}(h=[]).push(u+" total","","",r,i),t.push(h),s+=r,c+=i;var v=[];return v.push("Grand total","","",s,c),t.push(v),t}(n,a);o.getFiltersAsync().then((function(e){e=e.map((function(e){return function(e){var t=e.appliedValues.map((function(e){return e.formattedValue})).toString();return e.fieldName+": "+t}(e)})),l[1][3]=e.toString(),function(e){var t,n,a=y.a.utils.decode_range(e["!ref"]);for(t=a.s.r;t<=a.e.r;t++)for(n=a.s.c;n<=a.e.c;n++){var o=e[y.a.utils.encode_cell({r:t,c:n})];if("undefined"!==typeof o){var l=3==t?{fgColor:{rgb:"DCE6F3"}}:null,r=3==t?{bold:!0}:null,i="Furniture total"==o.v||"Office Supplies total"==o.v||"Technology total"==o.v||"Grand total"==o.v?{bold:!0}:null,s=t>3?{fgColor:{rgb:"C4BD97"}}:null,c="Grand total"==o.v||t==a.e.r?{fgColor:{rgb:"948A54"}}:null,u=t>=3?{vertical:"center",horizontal:"bottom"}:null,d=2==t?{style:"medium",color:{auto:1}}:null,g={border:{}};null!=d&&(g.border.top=d),null!=l&&(g.fill=l),null!=u&&(g.alignment=u),null!=r&&(g.font=r),null!=i&&(g.font=i),null!=s&&(g.fill=s),null!=c&&(g.fill=c,t),t>3&&(3==n||4==n)&&(g.numFmt="$#,##0.00"),o.s=g}}}(n=y.a.utils.aoa_to_sheet(l)),n["!merges"]=function(e){console.log("getCellMergeArray");var t=[];return t.push({s:{c:0,r:0},e:{c:1,r:1}}),t}(),n["!cols"]=D(l[0]),n["!rows"]=function(e){var t,n=[],a=y.a.utils.decode_range(e["!ref"]);for(t=a.s.r;t<=a.e.r;t++){var o=e[y.a.utils.encode_cell({r:t,c:0})];"undefined"!==typeof o?"Furniture"==o.v||"Office Supplies"==o.v||"Technology"==o.v?n.push({level:2,hidden:!0}):"Furniture total"==o.v||"Office Supplies total"==o.v||"Technology total"==o.v?n.push({level:1,hidden:!1}):(o.v,n.push({level:0,hidden:!1})):n.push({level:0,hidden:!1})}return n}(n);var a=y.a.utils.book_new();y.a.utils.book_append_sheet(a,n,"Sheet 1"),t(a)}))}))})),o}))}))};var D=function(e){for(var t=[],n=0;n<e.length;n++)t.push({wch:e[n].length+15});return t};var H=function(e,t){return new Promise((function(n,a){for(var o=[],l=0;l<t.length;l++)o.push(T(e,t[l]));Promise.all(o).then((function(e){n(e)}))}))},T=function(e,t){return new Promise((function(n,a){for(var o={},l=0;l<e.length;l++)if(e[l].selected){var r=void 0,i=void 0;switch(e[l]._dataType){case"int":case"float":r="n",i=Number(t[l].value),isNaN(i)&&(i=t[l].formattedValue);break;case"date":case"date-time":r="s",i=t[l].formattedValue;break;case"bool":r="b",i=t[l].value;break;default:r="s",i=t[l].formattedValue}var s={v:i,t:r};o[e[l].outputName]=s}n(o)}))};var B=n(298),F=n.n(B);var M=function(e){function t(t){var n="";t&&(n=JSON.stringify(t)),console.log(e),console.log("[Extension.js] configure Sending payload",n);"".concat(window.location,"/configure");e.toChangeConfiguration(!0)}return Object(a.useEffect)((function(){console.log("[Extension.js] Props Changed",e)}),[e]),Object(a.useEffect)((function(){console.log("[Extension.js] useEffect"),console.log("[Extension.js] Initialise Extension",e),tableau.extensions.initializeAsync({configure:t}).then((function(){var n=tableau.extensions.settings.get("selectedSheets");n&&null!=n?(console.log("[Extension.js] Existing Sheet Settings Found",JSON.parse(n)),e.updateMeta(JSON.parse(n)),e.disableButton(!1)):(console.log("[Extension.js] Can't find existing sheet settings"),O().then((function(t){return e.updateMeta(t),j("sheets",t),j("label","Export All"),C()})).then((function(e){return t(e)})));var a=tableau.extensions.settings.get("buttonLabel");a&&null!=a&&(a=a.replace(/"/g,""),console.log("[Extension.js] initializeAsync Existing Label Settings Found",a),e.updateLabel(a));var o=tableau.extensions.settings.get("buttonStyle");o&&null!=o&&(console.log("[Extension.js] initializeAsync Existing Label Style Found",o),e.updateButtonStyle(o));var l=tableau.extensions.settings.get("filename");l&&null!=l&&(console.log("[Extension.js] initializeAsync Existing Filename Found",l),e.updateFilename(l))}))}),[]),o.a.createElement(p,{label:e.label,style:e.style,disabled:e.disabled,export:function(){"server"===tableau.extensions.environment.context?w(e.meta,"server",e.filename):(console.log("[Extension.js] Tableau Version",tableau.extensions.environment.tableauVersion),F.a.compare(tableau.extensions.environment.tableauVersion,"2019.4.0",">=")?w(e.meta,"desktop",e.filename):function(){var e="".concat(window.location.origin,"/desktopexport");tableau.extensions.ui.displayDialogAsync(e,"",{height:350,width:400}).then((function(e){console.log("[Extension.js] Export window closed")})).catch((function(e){switch(e.errorCode){case tableau.ErrorCodes.DialogClosedByUser:console.log("[Extension.js] Export window was closed by user");break;default:console.error("[Extension.js]",e.message)}}))}())}})},A=n(301),P=n(654),_=n(19),L=n(660),I=n(656),z=n(659),R=Object(P.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},details:{alignItems:"center"},column:{flexBasis:"50%"},label:{display:"block",fontSize:10,lineHeight:"10px",order:0,marginBottom:3},group:{color:"rgba(0, 0, 0, 0.56)",display:"inline-flex",flexDirection:"column",fontFamily:"Benton Sans, Arial, Helvetica, sans-serif",position:"relative"},stepper:{marginBottom:13},strikeThrough:{textDecoration:"line-through",marginRight:5,color:"rgba(156, 156, 156, 0.8)"}}})),J=Object(_.a)({root:{boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(L.a);var V=function(e){var t,n,a=R(),l={label:"Rename",onChange:function(t){return e.changeName(t.target.value)},onClear:function(){e.changeName(null)},placeholder:e.name||"Override Export Tab Name",style:{width:200},value:e.rename||""};return o.a.createElement("div",{className:a.root},o.a.createElement(J,{square:!0,expanded:e.selected},o.a.createElement(z.a,{"aria-controls":"panel1c-content",id:"panel1c-header"},o.a.createElement("div",null,o.a.createElement(h.Checkbox,{checked:e.selected,onChange:e.select},(t=e.name,(n=e.rename)?o.a.createElement("div",null,o.a.createElement("span",{className:a.strikeThrough},t),o.a.createElement("span",null,n)):o.a.createElement("div",null,t))))),o.a.createElement(I.a,{className:a.details},o.a.createElement("div",{className:a.column},o.a.createElement(h.TextField,l)),o.a.createElement("div",{className:a.column},o.a.createElement("div",{className:a.group},o.a.createElement("label",{className:a.label},"Change Order"),o.a.createElement(h.Stepper,{min:1,max:e.sheets.length,step:1,pageSteps:1,value:e.id+1,onValueChange:function(t){return e.changeOrder(t)},className:a.stepper}))))))};var U=function(e){return e&&e.sheets?e.sheets.map((function(t,n){return o.a.createElement(V,{id:n,key:t.sheetName,name:t.sheetName,rename:t.changeName,sheets:e.sheets,selected:t.selected,select:function(){return e.selectSheet(n)},changeName:function(t){return e.changeName(n,t)},changeOrder:function(t){return e.changeOrder(n,t)}})})):o.a.createElement("div",null)},G=n(299),W=n.n(G),$=Object(P.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},details:{alignItems:"center"},column:{flexBasis:"50%"},label:{display:"block",fontSize:10,lineHeight:"10px",order:0,marginBottom:3},group:{color:"rgba(0, 0, 0, 0.56)",display:"inline-flex",flexDirection:"column",fontFamily:"Benton Sans, Arial, Helvetica, sans-serif",position:"relative"},stepper:{marginBottom:13},strikeThrough:{textDecoration:"line-through",color:"rgba(156, 156, 156, 0.8)",marginRight:5}}})),q=Object(_.a)({root:{boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(L.a);var Y=function(e){var t,n,a=$(),l={label:"Rename",onChange:function(t){return e.changeName(t.target.value)},onClear:function(){e.changeName(null)},placeholder:e.name||"Override Export Column Name",style:{width:200},value:e.rename||""};return o.a.createElement("div",{className:a.root},o.a.createElement(q,{square:!0},o.a.createElement(z.a,{expandIcon:o.a.createElement(W.a,null),"aria-controls":"panel1c-content",id:"panel1c-header"},o.a.createElement("div",null,o.a.createElement(h.Checkbox,{checked:e.selected,onChange:e.select},(t=e.name,(n=e.rename)?o.a.createElement("div",null,o.a.createElement("span",{className:a.strikeThrough},t),o.a.createElement("span",null,n)):o.a.createElement("div",null,t))))),o.a.createElement(I.a,{className:a.details},o.a.createElement("div",{className:a.column},o.a.createElement(h.TextField,l)),o.a.createElement("div",{className:a.column},o.a.createElement("div",{className:a.group},o.a.createElement("label",{className:a.label},"Change Order"),o.a.createElement(h.Stepper,{min:1,max:e.cols.length,step:1,pageSteps:1,value:e.id+1,onValueChange:function(t){return e.changeOrder(t)},className:a.stepper}))))))};var K=function(e){return e&&e.cols?e.cols.map((function(t,n){return o.a.createElement(Y,{id:n,key:t.name,name:t.name,rename:t.changeName,selected:t.selected,select:function(){return e.colSelect(e.id,n)},changeName:function(t){return e.changeName(e.id,n,t)},cols:e.cols,changeOrder:function(t){return e.changeOrder(e.id,n,t)}})})):o.a.createElement("div",null)};var Q=function(e){return e&&e.sheets?e.sheets.map((function(t,n){return t.selected?o.a.createElement("div",{key:t.sheetName},o.a.createElement("div",null,o.a.createElement("b",null,t.sheetName)),o.a.createElement(K,{id:n,name:t.sheetName,cols:t.columns,colSelect:e.colSelect,changeName:e.changeName,changeOrder:e.changeOrder})):o.a.createElement("div",{key:t.sheetName})})):o.a.createElement("div",null)},X={bottom:10,right:10,position:"fixed"};var Z=function(e){return o.a.createElement("div",{style:X},o.a.createElement(h.Button,{kind:"outline",style:{marginRight:12},onClick:e.resetSettings},"Reset"),o.a.createElement(h.Button,{kind:"primary",style:{marginRight:12},disabled:!e.enableButton,onClick:e.save},"Save Changes"))},ee=n(657),te=Object(P.a)((function(e){return{root:{flexGrow:1}}}));var ne=function(e){var t=te(),n={label:"Button Label",onChange:function(t){console.log("[ConfigureTab.js] Updating Button Label",t.target.value),e.updateLabel(t.target.value)},onClear:function(){e.updateLabel("Export All")},placeholder:"Button Label",style:{width:400},value:e.label||""},a={label:"Export Filename",onChange:function(t){return e.updateFilename(JSON.stringify(t.target.value))},onClear:function(){e.updateFilename("ExportAll")},placeholder:"Export Filename",style:{width:400},value:e.filename||""};return o.a.createElement("div",{className:t.root},o.a.createElement(ee.a,{container:!0},o.a.createElement(ee.a,{item:!0,xs:12},o.a.createElement(h.TextField,n)),o.a.createElement(ee.a,{item:!0,xs:12},o.a.createElement(h.TextField,a)),o.a.createElement(ee.a,{item:!0,xs:12},o.a.createElement(o.a.Fragment,null,"Set Button Style to:",o.a.createElement(h.DropdownSelect,{kind:"line",value:e.style,onChange:function(t){return e.updateButtonStyle(JSON.stringify(t.target.value))},style:{marginLeft:10}},o.a.createElement("option",null,"outline"),o.a.createElement("option",null,"primary"),o.a.createElement("option",null,"destructive"))))))},ae=(n(633),{height:"calc(100vh - 170px)"});var oe=function(e){var t=Object(a.useState)(0),n=Object(A.a)(t,2),l=n[0],r=n[1];function i(e,t,n){if(n>=e.length)for(var a=n-e.length+1;a--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}return console.log("[Configure.js] Initialise Config Screen",e),Object(a.useEffect)((function(){console.log("[Configure.js] useEffect"),tableau.extensions.initializeDialogAsync().then((function(t){console.log("[Configure.js] Initialise Dialog",t);var n=tableau.extensions.settings.get("selectedSheets");n&&null!=n&&(console.log("[Configure.js] Existing Sheet Settings Found",n),e.updateMeta(JSON.parse(n)));var a=tableau.extensions.settings.get("buttonLabel");a&&null!=a&&(a=a.replace(/"/g,""),console.log("[Configure.js] initializeDialogAsync Existing Label Settings Found",a),e.updateLabel(a));var o=tableau.extensions.settings.get("buttonStyle");o&&null!=o&&(console.log("[Configure.js] initializeDialogAsync Existing Label Style Found",o),e.updateButtonStyle(o));var l=tableau.extensions.settings.get("filename");l&&null!=l&&(console.log("[Configure.js] initializeDialogAsync Existing Filename Found",l),e.updateFilename(l))}))}),[]),o.a.createElement("div",null,o.a.createElement(h.Tabs,{onTabChange:function(e){r(e)},selectedTabIndex:l,tabs:[{content:"Select Sheets"},{content:"Select Columns"},{content:"Configure"}]},o.a.createElement("div",{style:ae},0===l?o.a.createElement(U,{sheets:e.meta,selectSheet:function(t){console.log("[Configure.js] selectSheetHandler",t);var n=e.meta;n[t].selected=!n[t].selected,e.updateMeta(n),e.changeSettings(!0)},changeOrder:function(t,n){if(console.log("[Configure.js] changeSheetOrderHandler",t,n),n>0){var a=i(e.meta,t,n-1);e.updateMeta(a),e.changeSettings(!0)}},changeName:function(t,n){console.log("[Configure.js] changeSheetNameHandler",t,n);var a=e.meta;a[t].changeName=n,e.updateMeta(a),e.changeSettings(!0)}}):null,1===l?o.a.createElement(Q,{sheets:e.meta,colSelect:function(t,n){console.log("[Configure.js] selectColumnHandler",t,n);var a=e.meta,o=a[t];o.columns[n].selected=!o.columns[n].selected,a[t]=o,e.updateMeta(a),e.changeSettings(!0)},changeName:function(t,n,a){console.log("[Configure.js] changeColumnNameHandler",t,n,a);var o=e.meta,l=o[t];l.columns[n].changeName=a,o[t]=l,e.updateMeta(o),e.changeSettings(!0)},changeOrder:function(t,n,a){if(console.log("[Configure.js] changeColumnOrderHandler",t,n,a),a>0){var o=e.meta,l=i(o[t].columns,n,a-1);o[t].columns=l,e.updateMeta(o),e.changeSettings(!0)}}}):null,2===l?o.a.createElement(ne,{label:e.label,filename:e.filename,style:e.style,updateLabel:function(t){console.log("[Configure.js] changeUpdateLabelHandler",t),e.updateLabel(t),e.changeSettings(!0)},updateButtonStyle:function(t){console.log("[Configure.js] changeLabelStyleHandler",t),e.updateButtonStyle(t),e.changeSettings(!0)},updateFilename:function(t){console.log("[Configure.js] updateFilenameHandler",t),e.updateFilename(t),e.changeSettings(!0)}}):null)),o.a.createElement(Z,{enableButton:e.enableSave,save:function(){console.log("[Configure.js] saveSettingsHandler - Saving Settings",e);var t=e.meta,n=e.label,a=e.style,o=e.filename;e.toChangeConfiguration(!1),e.disableButton(!1),j("sheets",t).then(j("label",n)).then(j("style",a)).then(j("filename",o)).then(C()).then(e.changeSettings(!1))},resetSettings:function(){console.log("[Configure.js] resetSettingsHandler - Reset Settings"),e.resetSettings()}}))},le=n(658);n(634);var re=function(){return console.log("[DesktopExport.js] Initialise Export Screen"),encodeURI("Hi Michael,\n\nI'm such a huge fan of the Export All extension created by Craig Bloodworth. Trouble is my users make use of Tableau Desktop just as much as Server and I really want them to feel the same love for all things data in Excel. Please please please please enable the downloads API in extensions. It would make such a huge difference to my Tableau life. I promise I won't export all my data, just the important stuff.\n\nThanks so much for your time and helping to build an amazing product!"),Object(a.useEffect)((function(){console.log("[DesktopExport.js] useEffect"),tableau.extensions.initializeDialogAsync().then((function(e){console.log("[DesktopExport.js] Initialise Dialog",e);tableau.extensions.settings.get("selectedSheets")}))}),[]),o.a.createElement(ee.a,{container:!0,spacing:0,align:"left",justify:"center"},o.a.createElement(ee.a,{item:!0},o.a.createElement(le.a,{component:"div",style:{padding:20}},o.a.createElement("p",null,"Hi There!"),o.a.createElement("p",null,"It looks like you're trying to create the Excel file using a desktop version earlier than 2019.4. Unfortunately you ","can't"," as the download function is disabled, however there are two solutions. Either publish your dashboard to Server where the Excel file will download as expected, or upgrade your copy of Desktop to 2019.4 or greater."),o.a.createElement("p",null,"To those who've previously emailed Tableau to request they enable the download feature...we did it!! Thank you so much for taking the time to present the case, I ","can't"," believe how many emails you sent. ","I'm"," humbled."),o.a.createElement("p",null,"Craig"))))};n(635);function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(n,!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){function t(e){var n;return Object(s.a)(this,t),console.log("[Main.js] constructor"),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).labelChangedHandler=function(e){console.log("[Main.js] Updating label text to ".concat(e));var t=se({},n.state.button,{label:e});n.setState({button:t})},n.filenameChangedHandler=function(e){console.log("[Main.js] Updating filename to ".concat(JSON.parse(e))),n.setState({filename:JSON.parse(e)})},n.changeConfiguration=function(e){console.log("[Main.js] changeToconConfiguration ".concat(e)),n.setState({toConfiguration:e})},n.buttonStateChangedHandler=function(e){console.log("[Main.js] Changing button state to ".concat(e));var t=se({},n.state.button,{disabled:e});n.setState({button:t})},n.buttonStyleChangedHandler=function(e){console.log("[Main.js] Changing button style to ".concat(e));var t=se({},n.state.button,{style:JSON.parse(e)});n.setState({button:t})},n.metaChangedHandler=function(e){console.log("[Main.js] Meta changed",e),n.setState({meta:e})},n.settingsChangedHandler=function(e){console.log("[Main.js] Settings changed"),n.setState({settingsChanged:e})},n.resetSettingsHandler=function(){console.log("[Main.js] Reset Settings"),n.setState({meta:void 0,button:{label:"Export All",style:"outline",disabled:!0},isLoading:!1,filename:"ExportAll",settingsChanged:!1})},n.renderExtension=function(){return o.a.createElement(M,{label:n.state.button.label,meta:n.state.meta,style:n.state.button.style,toChangeConfiguration:n.changeConfiguration,filename:n.state.filename,disabled:n.state.button.disabled,updateMeta:n.metaChangedHandler,disableButton:n.buttonStateChangedHandler,updateLabel:n.labelChangedHandler,updateButtonStyle:n.buttonStyleChangedHandler,updateFilename:n.filenameChangedHandler})},n.renderConfigure=function(){return o.a.createElement(oe,{label:n.state.button.label,meta:n.state.meta,style:n.state.button.style,filename:n.state.filename,enableSave:n.state.settingsChanged,updateMeta:n.metaChangedHandler,disableButton:n.buttonStateChangedHandler,toChangeConfiguration:n.changeConfiguration,updateLabel:n.labelChangedHandler,changeSettings:n.settingsChangedHandler,updateButtonStyle:n.buttonStyleChangedHandler,updateFilename:n.filenameChangedHandler,resetSettings:n.resetSettingsHandler})},n.renderDesktopExport=function(){return o.a.createElement(re,null)},n.state={toConfiguration:!1,meta:void 0,button:{label:"Export All",style:"outline",disabled:!0},isLoading:!1,filename:"ExportAll",settingsChanged:!1},console.log("[Main.js] state initialised",n.state),n}return Object(g.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){console.log("[Main.js] componentWillMount")}},{key:"componentDidMount",value:function(){console.log("[Main.js] componentDidMount")}},{key:"render",value:function(){return this.state.toConfiguration?o.a.createElement(m.a,{basename:"/Tableau-Extension-Export-Naya/build/"},o.a.createElement(f.a,{path:"/",render:this.renderConfigure})):o.a.createElement(m.a,{basename:"/Tableau-Extension-Export-Naya/build/"},o.a.createElement(f.a,{path:"/",render:this.renderExtension}),o.a.createElement(f.a,{path:"/configure",render:this.renderConfigure}),o.a.createElement(f.a,{path:"/desktopexport",render:this.renderDesktopExport}))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(ce,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[311,1,2]]]);
//# sourceMappingURL=main.4bccb9dc.chunk.js.map